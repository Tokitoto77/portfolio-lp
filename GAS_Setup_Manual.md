# 予約システム設定マニュアル（お客様用）

この設定を行うことで、お客様のGoogleスプレッドシートに予約が自動で入り、お客様のGmailアドレスから自動返信メールが送られるようになります。
所要時間は10分〜15分ほどです。

---

## ステップ1：スプレッドシートの準備

1. Googleドライブ（[drive.google.com](https://drive.google.com/)）を開き、左上の **「＋ 新規」** ＞ **「Google スプレッドシート」** をクリックします。
2. 左上の「無題のスプレッドシート」をクリックし、好きな名前に変更します（例：`予約管理表`）。
3. メニューバーにある **「拡張機能」** ＞ **「Apps Script」** をクリックします。

---

## ステップ2：プログラムの貼り付け

1. 「無題のプロジェクト」という画面が開きます（これがプログラムを書く場所です）。
2. 元々書かれている `function myfunction() { ... }` という文字をすべて消して、**真っ白**にします。
3. **別紙でお渡しした「システム用コード」** をすべてコピーし、ここに貼り付けます。
4. 画面上部の「💾（保存）」アイコンをクリックします（プロジェクト名は適当でOKです）。

---

## ステップ3：スプレッドシートIDの設定

1. さきほど作った「スプレッドシート」の画面に戻ります。
2. ブラウザ上部のURLを見てください。
   `https://docs.google.com/spreadsheets/d/` **ここから** `/edit...` **の前まで** の英数字の羅列をコピーします。
   （例：`1ulngUkF1HaUb_OnAPC...` のような長い文字列です）
3. Apps Scriptの画面に戻り、コードの1行目 `var spreadsheetId = '...';` の `' '` の中身を、コピーしたIDに書き換えます。
   ※同様に、もしGoogleカレンダーと連携する場合は、2行目のカレンダーIDも書き換えます。

---

## ステップ4：承認とテスト（最重要）

1. コードエディタの上部にあるリストボックスから **「testAuth」** を選択します。
2. **「実行」** ボタンをクリックします。
3. **「承認が必要です」** という画面が出たら、以下の手順で進めてください。
   - 「権限を確認」をクリック
   - ご自身のGoogleアカウントを選択
   - ⚠️「このアプリはGoogleで確認されていません」と出た場合：
     左下の **「詳細」** をクリックし、**「（安全ではないページ）に移動」** をクリックします。
   - 最後に **「許可」** をクリックします。
4. 画面下の実行ログに「実行完了」と出ればOKです。

---

## ステップ5：公開（デプロイ）

1. 画面右上の青いボタン **「デプロイ」** ＞ **「新しいデプロイ」** をクリックします。
2. **「種類の選択」**（歯車マーク）の隣にある「Webアプリ」が選択されていることを確認します（なければ選択）。
3. 以下の設定になっているか必ず確認してください：
   - **次のユーザーとして実行**：`自分（メールアドレス）`
   - **アクセスできるユーザー**：`全員`（⚠️ここが「全員」でないと動きません）
4. **「デプロイ」** ボタンをクリックします。
5. **「ウェブアプリ」** の下に表示された URL（`https://script.google.com/...`）をコピーします。

---

## 完了

コピーしたURLを制作者（私）にお送りください。
これを予約フォームに連携させることで、システムが動き出します！
